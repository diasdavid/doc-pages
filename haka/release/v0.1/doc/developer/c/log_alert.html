


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3.4. Log &amp; Alert &mdash; Haka runtime 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/haka.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/scripts.js"></script>
    <link rel="top" title="Haka runtime 0.1.0 documentation" href="../../../index.html" />
    <link rel="up" title="3. C API" href="../c.html" />
    <link rel="next" title="3.5. Packet" href="packet.html" />
    <link rel="prev" title="3.3. Threads" href="thread.html" /> 
  </head>
  <body>
<header id="header" role="banner">
  <div class="home-link">
    <div id="version" class="description">Version 0.1.0</div>
    <h1 class="title"><a rel="home" title="Haka" href="http://www.haka-security.org">Haka</a></h1>
    <h2 class="description">Software Defined Security</h2>
  </div>
</header>

  <div id="navbar" class="navbar">
    <nav id="site-navigation" class="navigation main-navigation" role="navigation">
      <ul class="nav-menu">
        <li class=" ">
          <a href="../../user/userindex.html">Users</a>
        </li>
        <li class=" ">
          <a href="../../ref/refindex.html" class="../../ref/refindex.html">References</a>
        </li>
        <li class=" current">
          <a href="../devindex.html" class="">Developers</a>
        </li>
        <li>


	<div id="searchbox" style="display: none">
		<form class="search" action="../../../search.html" method="get">
			<input type="hidden" name="area" value="default" />
			<input type="hidden" name="check_keywords" value="yes" />
			<input type="text" name="q" placeholder="Search" />
		</form>
	</div>
	<script type="text/javascript">$('#searchbox').show(0);</script>
</li>
          <li class="right"><a href="../c.html" title="3. C API">Up</a></li>
          <li class="right"><a href="thread.html" title="3.3. Threads">Prev</a></li>
          <li class="right"><a href="packet.html" title="3.5. Packet">Next</a></li>
         <li class=" right"><a href="../../../genindex.html">Index</a></li>
         <li class=" right"><a href="../../../lua-modindex.html">Modules</a></li>
      </ul>
    </nav>
  </div>
  <div id="content" class="body">
    <div id="contentwrapper">
      
  <div class="section" id="log-alert">
<h1>3.4. Log &amp; Alert<a class="headerlink" href="#log-alert" title="Permalink to this headline">¶</a></h1>
<div class="section" id="log">
<h2>3.4.1. Log<a class="headerlink" href="#log" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="log_level">
<tt class="descname">log_level</tt><a class="headerlink" href="#log_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Logging level constants.</p>
<dl class="member">
<dt id="log_level.HAKA_LOG_FATAL">
<tt class="descname">HAKA_LOG_FATAL</tt><a class="headerlink" href="#log_level.HAKA_LOG_FATAL" title="Permalink to this definition">¶</a></dt>
<dt id="log_level.HAKA_LOG_ERROR">
<tt class="descname">HAKA_LOG_ERROR</tt><a class="headerlink" href="#log_level.HAKA_LOG_ERROR" title="Permalink to this definition">¶</a></dt>
<dt id="log_level.HAKA_LOG_WARNING">
<tt class="descname">HAKA_LOG_WARNING</tt><a class="headerlink" href="#log_level.HAKA_LOG_WARNING" title="Permalink to this definition">¶</a></dt>
<dt id="log_level.HAKA_LOG_INFO">
<tt class="descname">HAKA_LOG_INFO</tt><a class="headerlink" href="#log_level.HAKA_LOG_INFO" title="Permalink to this definition">¶</a></dt>
<dt id="log_level.HAKA_LOG_DEBUG">
<tt class="descname">HAKA_LOG_DEBUG</tt><a class="headerlink" href="#log_level.HAKA_LOG_DEBUG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="level_to_str">
const char *<tt class="descname">level_to_str</tt><big>(</big><a class="reference internal" href="#log_level" title="log_level">log_level</a><em>&nbsp;level</em><big>)</big><a class="headerlink" href="#level_to_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a logging level to a human readable string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A string representing the logging level. This string is constant and should
not be freed.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="message">
void <tt class="descname">message</tt><big>(</big><a class="reference internal" href="#log_level" title="log_level">log_level</a><em>&nbsp;level</em>, const <a class="reference internal" href="utils.html#wchar_t" title="wchar_t">wchar_t</a><em>&nbsp;*module</em>, const <a class="reference internal" href="utils.html#wchar_t" title="wchar_t">wchar_t</a><em>&nbsp;*message</em><big>)</big><a class="headerlink" href="#message" title="Permalink to this definition">¶</a></dt>
<dd><p>Log a message without string formating.</p>
</dd></dl>

<dl class="function">
<dt id="messagef">
void <tt class="descname">messagef</tt><big>(</big><a class="reference internal" href="#log_level" title="log_level">log_level</a><em>&nbsp;level</em>, const <a class="reference internal" href="utils.html#wchar_t" title="wchar_t">wchar_t</a><em>&nbsp;*module</em>, const <a class="reference internal" href="utils.html#wchar_t" title="wchar_t">wchar_t</a><em>&nbsp;*fmt</em>, ...<big>)</big><a class="headerlink" href="#messagef" title="Permalink to this definition">¶</a></dt>
<dd><p>Log a message with string formating.</p>
</dd></dl>

<dl class="function">
<dt id="setlevel">
void <tt class="descname">setlevel</tt><big>(</big><a class="reference internal" href="#log_level" title="log_level">log_level</a><em>&nbsp;level</em>, const <a class="reference internal" href="utils.html#wchar_t" title="wchar_t">wchar_t</a><em>&nbsp;*module</em><big>)</big><a class="headerlink" href="#setlevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the logging level to display for a given module name. The <cite>module</cite> parameter can be
<cite>NULL</cite> in which case it will set the default level.</p>
</dd></dl>

<dl class="function">
<dt id="getlevel">
<a class="reference internal" href="#log_level" title="log_level">log_level</a> <tt class="descname">getlevel</tt><big>(</big>const <a class="reference internal" href="utils.html#wchar_t" title="wchar_t">wchar_t</a><em>&nbsp;*module</em><big>)</big><a class="headerlink" href="#getlevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the logging level for a given module name.</p>
</dd></dl>

</div>
<div class="section" id="alert">
<h2>3.4.2. Alert<a class="headerlink" href="#alert" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="alert_level">
<tt class="descname">alert_level</tt><a class="headerlink" href="#alert_level" title="Permalink to this definition">¶</a></dt>
<dd><dl class="member">
<dt id="alert_level.HAKA_ALERT_LOW">
<tt class="descname">HAKA_ALERT_LOW</tt><a class="headerlink" href="#alert_level.HAKA_ALERT_LOW" title="Permalink to this definition">¶</a></dt>
<dt id="alert_level.HAKA_ALERT_MEDIUM">
<tt class="descname">HAKA_ALERT_MEDIUM</tt><a class="headerlink" href="#alert_level.HAKA_ALERT_MEDIUM" title="Permalink to this definition">¶</a></dt>
<dt id="alert_level.HAKA_ALERT_HIGH">
<tt class="descname">HAKA_ALERT_HIGH</tt><a class="headerlink" href="#alert_level.HAKA_ALERT_HIGH" title="Permalink to this definition">¶</a></dt>
<dt id="alert_level.HAKA_ALERT_NUMERIC">
<tt class="descname">HAKA_ALERT_NUMERIC</tt><a class="headerlink" href="#alert_level.HAKA_ALERT_NUMERIC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="type">
<dt id="alert_completion">
<tt class="descname">alert_completion</tt><a class="headerlink" href="#alert_completion" title="Permalink to this definition">¶</a></dt>
<dd><dl class="member">
<dt id="alert_completion.HAKA_ALERT_FAILED">
<tt class="descname">HAKA_ALERT_FAILED</tt><a class="headerlink" href="#alert_completion.HAKA_ALERT_FAILED" title="Permalink to this definition">¶</a></dt>
<dt id="alert_completion.HAKA_ALERT_SUCCESSFUL">
<tt class="descname">HAKA_ALERT_SUCCESSFUL</tt><a class="headerlink" href="#alert_completion.HAKA_ALERT_SUCCESSFUL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="type">
<dt id="alert_node_type">
<tt class="descname">alert_node_type</tt><a class="headerlink" href="#alert_node_type" title="Permalink to this definition">¶</a></dt>
<dd><dl class="member">
<dt id="alert_node_type.HAKA_ALERT_NODE_ADDRESS">
<tt class="descname">HAKA_ALERT_NODE_ADDRESS</tt><a class="headerlink" href="#alert_node_type.HAKA_ALERT_NODE_ADDRESS" title="Permalink to this definition">¶</a></dt>
<dt id="alert_node_type.HAKA_ALERT_NODE_SERVICE">
<tt class="descname">HAKA_ALERT_NODE_SERVICE</tt><a class="headerlink" href="#alert_node_type.HAKA_ALERT_NODE_SERVICE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="type">
<dt>
struct <tt class="descname">alert</tt></dt>
<dd><p>Structure used to describe the alert.</p>
<dl class="member">
<dt id="alert.start_time">
time_us <tt class="descname">start_time</tt><a class="headerlink" href="#alert.start_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="alert.end_time">
time_us <tt class="descname">end_time</tt><a class="headerlink" href="#alert.end_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Alert times.</p>
</dd></dl>

<dl class="member">
<dt id="alert.description">
<a class="reference internal" href="utils.html#wchar_t" title="wchar_t">wchar_t</a> *<tt class="descname">description</tt><a class="headerlink" href="#alert.description" title="Permalink to this definition">¶</a></dt>
<dd><p>Description of the alert.</p>
</dd></dl>

<dl class="member">
<dt id="alert.severity">
<a class="reference internal" href="#alert_level" title="alert_level">alert_level</a> <tt class="descname">severity</tt><a class="headerlink" href="#alert.severity" title="Permalink to this definition">¶</a></dt>
<dd><p>Severity of the alert.</p>
</dd></dl>

<dl class="member">
<dt id="alert.confidence">
<a class="reference internal" href="#alert_level" title="alert_level">alert_level</a> <tt class="descname">confidence</tt><a class="headerlink" href="#alert.confidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Confidence of the detection.</p>
</dd></dl>

<dl class="member">
<dt id="alert.confidence_num">
double <tt class="descname">confidence_num</tt><a class="headerlink" href="#alert.confidence_num" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>confidence</cite> is HAKA_ALERT_NUMERIC, set this value as custom
confidence value.</p>
</dd></dl>

<dl class="member">
<dt id="alert.completion">
<a class="reference internal" href="#alert_completion" title="alert_completion">alert_completion</a> <tt class="descname">completion</tt><a class="headerlink" href="#alert.completion" title="Permalink to this definition">¶</a></dt>
<dd><p>Completion of the alert.</p>
</dd></dl>

<dl class="member">
<dt id="alert.method_description">
<a class="reference internal" href="utils.html#wchar_t" title="wchar_t">wchar_t</a> *<tt class="descname">method_description</tt><a class="headerlink" href="#alert.method_description" title="Permalink to this definition">¶</a></dt>
<dd><p>Description of the method used.</p>
</dd></dl>

<dl class="member">
<dt id="alert.method_ref">
<a class="reference internal" href="utils.html#wchar_t" title="wchar_t">wchar_t</a> **<tt class="descname">method_ref</tt><a class="headerlink" href="#alert.method_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>NULL terminated list of references.</p>
</dd></dl>

<dl class="member">
<dt id="alert.sources">
struct alert_node **<tt class="descname">sources</tt><a class="headerlink" href="#alert.sources" title="Permalink to this definition">¶</a></dt>
<dd><p>NULL terminated list of alert sources.</p>
</dd></dl>

<dl class="member">
<dt id="alert.targets">
struct alert_node **<tt class="descname">targets</tt><a class="headerlink" href="#alert.targets" title="Permalink to this definition">¶</a></dt>
<dd><p>NULL terminated list of alert targets.</p>
</dd></dl>

<dl class="member">
<dt id="alert.alert_ref_count">
size_t <tt class="descname">alert_ref_count</tt><a class="headerlink" href="#alert.alert_ref_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of external alert references.</p>
</dd></dl>

<dl class="member">
<dt id="alert.alert_ref">
<a class="reference internal" href="utils.html#uint64" title="uint64">uint64</a> *<tt class="descname">alert_ref</tt><a class="headerlink" href="#alert.alert_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of alert ids.</p>
</dd></dl>

</dd></dl>

<dl class="macro">
<dt id="ALERT">
<tt class="descname">ALERT</tt><big>(</big><a class="reference internal" href="module.html#name" title="name">name</a>, nsrc, ntgt<big>)</big><a class="headerlink" href="#ALERT" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a static alert description.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> &#8211; Name of the variable to create.</li>
<li><strong>nsrc</strong> &#8211; Number of sources.</li>
<li><strong>ntgt</strong> &#8211; Number of targets.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">ALERT</span><span class="p">(</span><span class="n">invalid_packet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nl">description:</span> <span class="s">L&quot;invalid tcp packet, size is too small&quot;</span><span class="p">,</span>
    <span class="nl">severity:</span> <span class="n">HAKA_ALERT_LOW</span><span class="p">,</span>
<span class="n">ENDALERT</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="ALERT_NODE">
<tt class="descname">ALERT_NODE</tt><big>(</big>alert, mode, index, <a class="reference internal" href="module.html#type" title="type">type</a>, ...<big>)</big><a class="headerlink" href="#ALERT_NODE" title="Permalink to this definition">¶</a></dt>
<dd><p>Append an alert node.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>alert</strong> &#8211; Alert name.</li>
<li><strong>mode</strong> &#8211; <tt class="docutils literal"><span class="pre">sources</span></tt> or <tt class="docutils literal"><span class="pre">target</span></tt>.</li>
<li><strong>index</strong> &#8211; Index of the node.</li>
<li><strong>type</strong> &#8211; Type of node (see <a class="reference internal" href="#alert_node_type" title="alert_node_type"><tt class="xref c c-type docutils literal"><span class="pre">alert_node_type</span></tt></a>).</li>
<li><strong>...</strong> &#8211; List of strings (<a class="reference internal" href="utils.html#wchar_t" title="wchar_t"><tt class="xref c c-type docutils literal"><span class="pre">wchar_t</span> <span class="pre">*</span></tt></a>).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">ALERT_NODE</span><span class="p">(</span><span class="n">invalid_packet</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HAKA_ALERT_NODE_ADDRESS</span><span class="p">,</span> <span class="s">&quot;127.0.0.1&quot;</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="ALERT_REF">
<tt class="descname">ALERT_REF</tt><big>(</big>alert, count, ...<big>)</big><a class="headerlink" href="#ALERT_REF" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a list of alert references.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>alert</strong> &#8211; Alert name.</li>
<li><strong>count</strong> &#8211; Number of references.</li>
<li><strong>...</strong> &#8211; List of alert ids.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="ALERT_METHOD_REF">
<tt class="descname">ALERT_METHOD_REF</tt><big>(</big>alert, ...<big>)</big><a class="headerlink" href="#ALERT_METHOD_REF" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a list of method references.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>alert</strong> &#8211; Alert name.</li>
<li><strong>...</strong> &#8211; List of strings (<a class="reference internal" href="utils.html#wchar_t" title="wchar_t"><tt class="xref c c-type docutils literal"><span class="pre">wchar_t</span> <span class="pre">*</span></tt></a>).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<a class="reference internal" href="utils.html#uint64" title="uint64">uint64</a> <tt class="descname">alert</tt><big>(</big>const struct alert<em>&nbsp;*alert</em><big>)</big></dt>
<dd><p>Raise a new alert.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A unique alert id.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="alert_update">
<a class="reference internal" href="utils.html#bool" title="bool">bool</a> <tt class="descname">alert_update</tt><big>(</big><a class="reference internal" href="utils.html#uint64" title="uint64">uint64</a><em>&nbsp;id</em>, const struct alert<em>&nbsp;*alert</em><big>)</big><a class="headerlink" href="#alert_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update an existing alert.</p>
</dd></dl>

</div>
</div>


    </div>
  </div>

<div id="footer">
  &copy; Copyright 2014, Arkoon Network Security, OpenWide and Telecom ParisTech.
</div>

  </body>
</html>